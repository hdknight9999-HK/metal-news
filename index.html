<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å…¨çƒé‡‘å±æƒ…æŠ¥å±€ (AI/å…‰ä¼/è´µé‡‘å±)</title>
    <style>
        :root {
            --bg-color: #0b1120;
            --card-bg: #1e293b;
            --text-main: #f1f5f9;
            --text-muted: #94a3b8;
            --gold: #fbbf24;     /* é»„é‡‘è‰² */
            --energy: #38bdf8;   /* é”‚/å…‰ä¼è“ */
            --copper: #f87171;   /* é“œ/AIè‰² */
        }
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
            background-color: var(--bg-color);
            color: var(--text-main);
            margin: 0;
            padding: 0;
            line-height: 1.6;
        }
        /* é¡¶éƒ¨å¯¼èˆª */
        header {
            background: rgba(15, 23, 42, 0.9);
            padding: 20px;
            border-bottom: 1px solid #334155;
            position: sticky;
            top: 0;
            z-index: 100;
            backdrop-filter: blur(10px);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        h1 { margin: 0; font-size: 20px; font-weight: 700; display: flex; align-items: center; gap: 10px; }
        .status-dot { height: 10px; width: 10px; background-color: #22c55e; border-radius: 50%; display: inline-block; box-shadow: 0 0 10px #22c55e; }
        
        /* å¸ƒå±€ */
        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
            display: grid;
            grid-template-columns: 350px 1fr; /* å·¦ä¾§è¡Œæƒ…ï¼Œå³ä¾§æ–°é—» */
            gap: 25px;
        }
        
        /* ä¾§è¾¹æ ï¼šè¡Œæƒ… */
        .sidebar {
            background: var(--card-bg);
            padding: 15px;
            border-radius: 12px;
            height: fit-content;
            border: 1px solid #334155;
        }
        
        /* æ ‡ç­¾é¡µè¿‡æ»¤ */
        .filter-bar {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            overflow-x: auto;
            padding-bottom: 5px;
        }
        .filter-btn {
            background: #334155;
            border: none;
            color: white;
            padding: 8px 16px;
            border-radius: 20px;
            cursor: pointer;
            font-size: 14px;
            white-space: nowrap;
            transition: all 0.3s;
        }
        .filter-btn.active { background: var(--gold); color: black; font-weight: bold; }
        .filter-btn:hover { opacity: 0.9; }

        /* æ–°é—»å¡ç‰‡ç½‘æ ¼ */
        .news-grid {
            display: grid;
            gap: 15px;
        }
        
        .news-card {
            background: var(--card-bg);
            padding: 20px;
            border-radius: 12px;
            border: 1px solid #334155;
            transition: transform 0.2s, box-shadow 0.2s;
            position: relative;
            overflow: hidden;
        }
        .news-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(0,0,0,0.3);
            border-color: var(--text-muted);
        }
        
        /* ç±»åˆ«æŒ‡ç¤ºæ¡ */
        .news-card::before {
            content: '';
            position: absolute;
            left: 0; top: 0; bottom: 0;
            width: 4px;
        }
        .news-card.type-precious::before { background: var(--gold); }
        .news-card.type-energy::before { background: var(--energy); }
        .news-card.type-industry::before { background: var(--copper); }

        .news-meta {
            font-size: 12px;
            color: var(--text-muted);
            margin-bottom: 8px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        .tag {
            padding: 2px 8px;
            border-radius: 4px;
            background: rgba(255,255,255,0.1);
            font-size: 11px;
        }
        .news-title {
            font-size: 18px;
            font-weight: 600;
            margin: 0 0 10px 0;
            line-height: 1.4;
        }
        .news-title a { color: var(--text-main); text-decoration: none; }
        .news-title a:hover { color: var(--gold); }
        
        .news-desc {
            font-size: 14px;
            color: #cbd5e1;
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
            overflow: hidden;
        }

        .loading-msg { text-align: center; padding: 40px; color: var(--text-muted); grid-column: 1 / -1; }
        .error-msg { color: #ef4444; background: rgba(239, 68, 68, 0.1); padding: 15px; border-radius: 8px; grid-column: 1 / -1; }

        /* å“åº”å¼ */
        @media (max-width: 850px) {
            .container { grid-template-columns: 1fr; }
            .sidebar { margin-bottom: 20px; }
        }
    </style>
</head>
<body>

<header>
    <div class="container" style="margin:0; padding:0; display:flex; width:100%;">
        <h1><span class="status-dot"></span> å…¨çƒé‡‘å±æƒ…æŠ¥å±€</h1>
        <div style="font-size: 12px; color: #94a3b8;">
            ç›‘æ§: è´µé‡‘å± / å…‰ä¼ / AIç®—åŠ›é‡‘å±
        </div>
    </div>
</header>

<div class="container">
    <!-- å·¦ä¾§ï¼šå®æ—¶è¡Œæƒ… (TradingView) -->
    <aside class="sidebar">
        <h3 style="border-bottom: 1px solid #334155; padding-bottom: 10px; margin-top:0;">å®æ—¶ç›˜é¢</h3>
        <div class="tradingview-widget-container">
            <div class="tradingview-widget-container__widget"></div>
            <script type="text/javascript" src="https://s3.tradingview.com/external-embedding/embed-widget-market-overview.js" async>
            {
            "colorTheme": "dark",
            "dateRange": "12M",
            "showChart": false,
            "locale": "zh_CN",
            "largeChartUrl": "",
            "isTransparent": true,
            "showSymbolLogo": true,
            "width": "100%",
            "height": "500",
            "tabs": [
                {
                "title": "è´µé‡‘å±",
                "symbols": [
                    { "s": "TVC:GOLD", "d": "ç°è´§é»„é‡‘" },
                    { "s": "TVC:SILVER", "d": "ç°è´§ç™½é“¶" },
                    { "s": "TVC:PLATINUM", "d": "é“‚é‡‘" }
                ]
                },
                {
                "title": "AIä¸å·¥ä¸š",
                "symbols": [
                    { "s": "COMEX:HG1!", "d": "é“œ (AI/å…‰ä¼)" },
                    { "s": "TVC:USOIL", "d": "åŸæ²¹" },
                    { "s": "COMEX:ALI1!", "d": "é“æœŸè´§" }
                ]
                },
                {
                "title": "æ–°èƒ½æº",
                "symbols": [
                    { "s": "COMEX:HG1!", "d": "é“œ" },
                    { "s": "TVC:SILVER", "d": "å…‰ä¼ç”¨é“¶" }
                ]
                }
            ]
            }
            </script>
        </div>
        <div style="margin-top: 15px; font-size: 12px; color: #64748b; line-height: 1.4;">
            * æ³¨ï¼šé”‚ã€ç¨€åœŸç­‰å°é‡‘å±å› äº¤æ˜“æ‰€é™åˆ¶ï¼Œå»ºè®®å…³æ³¨ä¸‹æ–¹æ–°é—»åŠ¨æ€ã€‚
        </div>
    </aside>

    <!-- å³ä¾§ï¼šæ–°é—»æµ -->
    <main>
        <div class="filter-bar">
            <button class="filter-btn active" onclick="filterNews('all', this)">å…¨éƒ¨åŠ¨æ€</button>
            <button class="filter-btn" onclick="filterNews('type-precious', this)">ğŸ’° é»„é‡‘/ç™½é“¶</button>
            <button class="filter-btn" onclick="filterNews('type-energy', this)">ğŸ”‹ é”‚/å…‰ä¼</button>
            <button class="filter-btn" onclick="filterNews('type-industry', this)">ğŸ¤– é“œ/AIé‡‘å±</button>
        </div>

        <div id="news-grid" class="news-grid">
            <div class="loading-msg">æ­£åœ¨æ¥å…¥å…¨çƒå«æ˜Ÿæ•°æ®ï¼Œæœç´¢å…‰ä¼ã€AIåŠè´µé‡‘å±åŠ¨æ€...<br>(å¦‚æœé•¿æ—¶é—´æ— ååº”ï¼Œè¯·åˆ·æ–°é¡µé¢)</div>
        </div>
    </main>
</div>

<script>
    // å®šä¹‰å…³é”®è¯ç»„
    // ä¸ºäº†ä¿è¯æ•°æ®å±•ç¤ºï¼Œæˆ‘ä»¬ä½¿ç”¨Bingä¸­æ–‡æœç´¢RSSï¼Œè¿™æ¯”rss2jsonæŠ“å–å›½å¤–ç½‘ç«™æ›´ç¨³å®šä¸”ä¸ç”¨ç¿»è¯‘
    const RSS_PROXY = "https://api.rss2json.com/v1/api.json?rss_url=";
    
    // æˆ‘ä»¬æ„å»ºä¸‰ä¸ªä¸åŒçš„æœç´¢æº
    const SOURCES = [
        {
            name: "è´µé‡‘å±",
            type: "type-precious",
            // æœç´¢: é»„é‡‘ä»·æ ¼ OR ç™½é“¶ä»·æ ¼ OR è´µé‡‘å±èµ°åŠ¿
            url: "https://www.bing.com/news/search?q=%E9%BB%84%E9%87%91%E4%BB%B7%E6%A0%BC+OR+%E7%99%BD%E9%93%B6%E8%B5%B0%E5%8A%BF&format=rss"
        },
        {
            name: "æ–°èƒ½æº/é”‚",
            type: "type-energy",
            // æœç´¢: ç¢³é…¸é”‚ä»·æ ¼ OR å…‰ä¼ç»„ä»¶ OR å¤ªé˜³èƒ½ é“¶æµ†
            url: "https://www.bing.com/news/search?q=%E7%A2%B3%E9%85%B8%E9%94%82%E4%BB%B7%E6%A0%BC+OR+%E5%85%89%E4%BC%8F%E4%BA%A7%E4%B8%9A+OR+%E5%85%89%E4%BC%8F+%E7%99%BD%E9%93%B6&format=rss"
        },
        {
            name: "AI/é“œ",
            type: "type-industry",
            // æœç´¢: é“œä»· OR AIç®—åŠ› èŠ¯ç‰‡ææ–™ OR é“œçŸ¿ä¾›åº”
            url: "https://www.bing.com/news/search?q=%E9%93%9C%E4%BB%B7+OR+AI%E7%AE%97%E5%8A%9B+%E7%A1%AC%E4%BB%B6+OR+%E5%85%A8%E7%90%83%E9%93%9C%E7%9F%BF&format=rss"
        }
    ];

    let allNewsData = [];

    async function fetchAllNews() {
        const container = document.getElementById('news-grid');
        const promises = SOURCES.map(source => {
            // å¯¹URLè¿›è¡Œç¼–ç 
            const encodedUrl = encodeURIComponent(source.url);
            return fetch(RSS_PROXY + encodedUrl)
                .then(res => res.json())
                .then(data => {
                    if(data.status === 'ok') {
                        return data.items.map(item => ({
                            ...item,
                            sourceName: source.name,
                            categoryType: source.type
                        }));
                    }
                    return [];
                })
                .catch(err => {
                    console.error("Fetch error:", err);
                    return [];
                });
        });

        try {
            const results = await Promise.all(promises);
            // åˆå¹¶æ‰€æœ‰ç»“æœ
            allNewsData = results.flat();

            // æŒ‰æ—¶é—´æ’åº (Bing RSSé€šå¸¸å¸¦pubDate)
            allNewsData.sort((a, b) => new Date(b.pubDate) - new Date(a.pubDate));
            
            // å»é‡ (æ ¹æ®æ ‡é¢˜)
            const seen = new Set();
            allNewsData = allNewsData.filter(item => {
                const duplicate = seen.has(item.title);
                seen.add(item.title);
                return !duplicate;
            });

            renderNews(allNewsData);

        } catch (error) {
            container.innerHTML = `<div class="error-msg">æ•°æ®è·å–å¤±è´¥ã€‚å¯èƒ½æ˜¯å…¬å…±æ¥å£ç¹å¿™ï¼Œè¯·è¿‡å‡ åˆ†é’Ÿå†åˆ·æ–°è¯•è¯•ã€‚<br>é”™è¯¯è¯¦æƒ…: ${error.message}</div>`;
        }
    }

    function renderNews(newsItems) {
        const container = document.getElementById('news-grid');
        if (newsItems.length === 0) {
            container.innerHTML = '<div class="loading-msg">æš‚æ— æœ€æ–°æ•°æ®ï¼Œè¯·ç¨åå†è¯•ã€‚</div>';
            return;
        }

        container.innerHTML = newsItems.map(item => {
            // å¤„ç†æ—¶é—´
            const date = new Date(item.pubDate);
            const timeStr = isNaN(date.getTime()) ? 'åˆšåˆš' : date.toLocaleString('zh-CN', {month:'2-digit', day:'2-digit', hour:'2-digit', minute:'2-digit'});
            
            // æ¸…ç†æè¿°ä¸­çš„HTML
            const cleanDesc = item.description ? item.description.replace(/<[^>]+>/g, '') : '';

            return `
                <div class="news-card ${item.categoryType}">
                    <div class="news-meta">
                        <span class="tag">${item.sourceName}</span>
                        <span>ğŸ•’ ${timeStr}</span>
                    </div>
                    <h3 class="news-title">
                        <a href="${item.link}" target="_blank">${item.title}</a>
                    </h3>
                    <div class="news-desc">${cleanDesc}</div>
                </div>
            `;
        }).join('');
    }

    // è¿‡æ»¤åŠŸèƒ½
    window.filterNews = function(type, btn) {
        // æ›´æ–°æŒ‰é’®çŠ¶æ€
        document.querySelectorAll('.filter-btn').forEach(b => b.classList.remove('active'));
        btn.classList.add('active');

        if (type === 'all') {
            renderNews(allNewsData);
        } else {
            const filtered = allNewsData.filter(item => item.categoryType === type);
            renderNews(filtered);
        }
    }

    // å¯åŠ¨
    fetchAllNews();
</script>

</body>
</html>
