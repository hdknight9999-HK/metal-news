<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å…¨çƒå…³é”®é‡‘å±æƒ…æŠ¥å±€ (ç»ˆæç¨³å®šç‰ˆ)</title>
    <style>
        :root {
            --bg-color: #0f172a;       
            --card-bg: #1e293b;        
            --text-main: #f8fafc;
            --text-muted: #94a3b8;
            --gold: #fbbf24;           
            --strategic: #d946ef;      /* è°ƒæ•´ä¸ºæ›´äº®çœ¼çš„ç´«çº¢è‰² (é”‘/é“Ÿ) */
            --industry: #38bdf8;       
        }
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
            background-color: var(--bg-color);
            color: var(--text-main);
            margin: 0;
            padding: 0;
            line-height: 1.6;
        }
        
        /* é¡¶éƒ¨å¯¼èˆª */
        header {
            background: rgba(15, 23, 42, 0.95);
            padding: 15px 20px;
            border-bottom: 1px solid #334155;
            position: sticky;
            top: 0;
            z-index: 100;
            backdrop-filter: blur(10px);
        }
        .header-content {
            max-width: 1400px;
            margin: 0 auto;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        h1 { margin: 0; font-size: 22px; font-weight: 700; display: flex; align-items: center; gap: 10px; }
        
        /* å¸ƒå±€ */
        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
            display: grid;
            grid-template-columns: 360px 1fr;
            gap: 25px;
        }
        
        /* ä¾§è¾¹æ  */
        .sidebar { display: flex; flex-direction: column; gap: 20px; }
        .price-card {
            background: var(--card-bg);
            padding: 15px;
            border-radius: 12px;
            border: 1px solid #334155;
        }
        
        /* æ ‡ç­¾é¡µè¿‡æ»¤ */
        .filter-bar {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }
        .filter-btn {
            background: #334155;
            border: 1px solid #475569;
            color: #cbd5e1;
            padding: 8px 18px;
            border-radius: 20px;
            cursor: pointer;
            font-size: 14px;
            transition: all 0.2s;
        }
        .filter-btn:hover { background: #475569; }
        .filter-btn.active { 
            background: var(--strategic); 
            color: white; 
            border-color: var(--strategic); 
            font-weight: bold;
            box-shadow: 0 0 10px rgba(217, 70, 239, 0.4);
        }
        .filter-btn.active.gold-btn { background: var(--gold); border-color: var(--gold); color: black; box-shadow: 0 0 10px rgba(251, 191, 36, 0.4); }
        .filter-btn.active.ind-btn { background: var(--industry); border-color: var(--industry); color: black; box-shadow: 0 0 10px rgba(56, 189, 248, 0.4); }

        /* æ–°é—»åˆ—è¡¨ */
        .news-grid { display: grid; gap: 15px; }
        
        .news-card {
            background: var(--card-bg);
            padding: 20px;
            border-radius: 12px;
            border: 1px solid #334155;
            position: relative;
            overflow: hidden;
            transition: transform 0.2s;
        }
        .news-card:hover { transform: translateY(-2px); border-color: var(--text-muted); }
        
        .news-card::before { content: ''; position: absolute; left: 0; top: 0; bottom: 0; width: 4px; }
        .news-card.type-strategic::before { background: var(--strategic); }
        .news-card.type-precious::before { background: var(--gold); }
        .news-card.type-industry::before { background: var(--industry); }

        .news-meta {
            font-size: 12px; color: var(--text-muted); margin-bottom: 8px;
            display: flex; align-items: center; gap: 10px;
        }
        .tag { padding: 2px 8px; border-radius: 4px; font-size: 11px; font-weight: bold; }
        .tag-strategic { background: rgba(217, 70, 239, 0.2); color: #f0abfc; }
        .tag-gold { background: rgba(251, 191, 36, 0.2); color: #fcd34d; }
        .tag-ind { background: rgba(56, 189, 248, 0.2); color: #7dd3fc; }

        .news-title { font-size: 18px; margin: 0 0 10px 0; line-height: 1.4; }
        .news-title a { color: var(--text-main); text-decoration: none; }
        .news-title a:hover { text-decoration: underline; color: var(--gold); }
        .news-desc { font-size: 14px; color: #cbd5e1; display: -webkit-box; -webkit-line-clamp: 2; -webkit-box-orient: vertical; overflow: hidden; }

        .status-msg { 
            grid-column: 1 / -1; padding: 30px; text-align: center; color: #94a3b8; 
            border: 1px dashed #334155; border-radius: 8px;
        }

        @media (max-width: 900px) {
            .container { grid-template-columns: 1fr; }
            .sidebar { order: -1; }
        }
    </style>
</head>
<body>

<header>
    <div class="header-content">
        <h1>ğŸ›°ï¸ å…¨çƒé‡‘å±æƒ…æŠ¥å±€</h1>
        <div style="font-size: 12px; color: #94a3b8;">
            é‡ç‚¹ç›‘æµ‹: é”‘/é“Ÿ (AIæˆ˜ç•¥) Â· é»„é‡‘ Â· é“œ
        </div>
    </div>
</header>

<div class="container">
    <!-- è¡Œæƒ…ä¾§è¾¹æ  -->
    <aside class="sidebar">
        <div class="price-card">
            <h3 style="margin-top:0; border-bottom:1px solid #334155; padding-bottom:10px;">ğŸ“Š å®æ—¶ä»·æ ¼é£å‘</h3>
            <div class="tradingview-widget-container">
                <div class="tradingview-widget-container__widget"></div>
                <script type="text/javascript" src="https://s3.tradingview.com/external-embedding/embed-widget-market-overview.js" async>
                {
                "colorTheme": "dark",
                "dateRange": "12M",
                "showChart": false,
                "locale": "zh_CN",
                "largeChartUrl": "",
                "isTransparent": true,
                "showSymbolLogo": true,
                "width": "100%",
                "height": "550",
                "tabs": [
                    {
                    "title": "æˆ˜ç•¥å°é‡‘å±",
                    "symbols": [
                        { "s": "AMEX:REMX", "d": "ç¨€æœ‰é‡‘å±ETF" },
                        { "s": "SZSE:002155", "d": "æ¹–å—é»„é‡‘ (é”‘)" },
                        { "s": "SZSE:000960", "d": "é”¡ä¸šè‚¡ä»½ (é“Ÿ)" },
                        { "s": "SZSE:002460", "d": "èµ£é”‹é”‚ä¸š" }
                    ]
                    },
                    {
                    "title": "è´µé‡‘å±",
                    "symbols": [
                        { "s": "TVC:GOLD", "d": "ç°è´§é»„é‡‘" },
                        { "s": "TVC:SILVER", "d": "ç°è´§ç™½é“¶" }
                    ]
                    },
                    {
                    "title": "AI/å…‰ä¼",
                    "symbols": [
                        { "s": "COMEX:HG1!", "d": "é“œ (AIç¡¬ä»¶)" },
                        { "s": "LME:AL", "d": "é“ (å…‰ä¼è¾¹æ¡†)" }
                    ]
                    }
                ]
                }
                </script>
            </div>
            <div style="margin-top:15px; font-size:12px; color:#64748b; padding:10px; background:#0f172a; border-radius:6px;">
                ğŸ’¡ é”‘ã€é“Ÿä¸ºåœºå¤–äº¤æ˜“å“ç§ï¼Œè¯·é‡ç‚¹å…³æ³¨ä¸Šæ–¹å¯¹åº”çš„é¾™å¤´è‚¡ï¼ˆæ¹–å—é»„é‡‘ã€é”¡ä¸šï¼‰èµ°åŠ¿ã€‚
            </div>
        </div>
    </aside>

    <!-- æ–°é—»åŒºåŸŸ -->
    <main>
        <div class="filter-bar">
            <button class="filter-btn active" onclick="filterNews('all', this)">å…¨éƒ¨</button>
            <button class="filter-btn" onclick="filterNews('type-strategic', this)">ğŸ§ª é”‘/é“Ÿ/ç¨€æœ‰</button>
            <button class="filter-btn gold-btn" onclick="filterNews('type-precious', this)">ğŸ’° é»„é‡‘/ç™½é“¶</button>
            <button class="filter-btn ind-btn" onclick="filterNews('type-industry', this)">ğŸ­ é“œ/é”‚/AI</button>
        </div>

        <div id="news-grid" class="news-grid">
            <div class="status-msg">
                ğŸ“¡ æ­£åœ¨é€šè¿‡å«æ˜Ÿé“¾è·¯è¿æ¥å…¨çƒæ•°æ®æº...<br>
                <span style="font-size:12px; opacity:0.7">æ­£åœ¨æ£€ç´¢ï¼šAntimony, Indium, Gold, Copper...</span>
            </div>
        </div>
    </main>
</div>

<script>
    // ä½¿ç”¨ AllOrigins ä½œä¸ºç¨³å®šä»£ç†ï¼Œç»•è¿‡è·¨åŸŸé™åˆ¶ï¼Œç›´æ¥è§£æ XML
    const PROXY_URL = "https://api.allorigins.win/raw?url=";
    
    // å®šä¹‰æ–°é—»æº (ä½¿ç”¨Bingæœç´¢RSSï¼ŒURLç¼–ç )
    // å…³é”®è¯ï¼šé”‘(Antimony), é“Ÿ(Indium), é•“, é”—
    const SOURCES = [
        {
            name: "æˆ˜ç•¥é‡‘å±",
            type: "type-strategic",
            tagClass: "tag-strategic",
            url: "https://www.bing.com/news/search?q=%E9%94%91%E4%BB%B7%E6%A0%BC+OR+%E9%93%9F%E4%BB%B7%E6%A0%BC+OR+%E6%88%98%E7%95%A5%E9%87%91%E5%B1%9E+%E7%AE%A1%E5%88%B6+OR+%E6%B9%96%E5%8D%97%E9%BB%84%E9%87%91+%E9%94%91&format=rss"
        },
        {
            name: "AIä¸å…‰ä¼",
            type: "type-industry",
            tagClass: "tag-ind",
            url: "https://www.bing.com/news/search?q=%E9%93%9C%E4%BB%B7+OR+AI%E7%AE%97%E5%8A%9B+%E6%9D%90%E6%96%99+OR+%E5%85%89%E4%BC%8F+%E9%93%B6%E6%B5%86+OR+%E7%A2%B3%E9%85%B8%E9%94%82&format=rss"
        },
        {
            name: "è´µé‡‘å±",
            type: "type-precious",
            tagClass: "tag-gold",
            url: "https://www.bing.com/news/search?q=%E9%BB%84%E9%87%91%E4%BB%B7%E6%A0%BC+OR+%E7%99%BD%E9%93%B6%E8%B5%B0%E5%8A%BF+OR+%E7%BE%8E%E8%81%94%E5%82%A8+%E9%99%8D%E6%81%AF&format=rss"
        }
    ];

    let allNewsData = [];

    // XMLè§£æå™¨
    const parser = new DOMParser();

    async function fetchAllNews() {
        const container = document.getElementById('news-grid');
        
        try {
            // å¹¶è¡Œè¯·æ±‚æ‰€æœ‰æº
            const promises = SOURCES.map(async (source) => {
                try {
                    const response = await fetch(PROXY_URL + encodeURIComponent(source.url));
                    if (!response.ok) throw new Error("Network response was not ok");
                    
                    const textData = await response.text();
                    const xml = parser.parseFromString(textData, "text/xml");
                    const items = xml.querySelectorAll("item");
                    
                    // å°†XMLèŠ‚ç‚¹è½¬æ¢ä¸ºJSå¯¹è±¡
                    return Array.from(items).map(item => {
                        const title = item.querySelector("title")?.textContent || "æ— æ ‡é¢˜";
                        const link = item.querySelector("link")?.textContent || "#";
                        const pubDate = item.querySelector("pubDate")?.textContent;
                        const desc = item.querySelector("description")?.textContent || "";
                        
                        return {
                            title: title,
                            link: link,
                            pubDate: pubDate ? new Date(pubDate) : new Date(),
                            desc: desc.replace(/<[^>]+>/g, '').substring(0, 100) + '...',
                            sourceLabel: source.name,
                            categoryType: source.type,
                            tagClass: source.tagClass
                        };
                    });
                } catch (err) {
                    console.warn(`Failed to fetch ${source.name}:`, err);
                    return []; // å•ä¸ªæºå¤±è´¥ä¸å½±å“æ•´ä½“
                }
            });

            const results = await Promise.all(promises);
            allNewsData = results.flat().sort((a, b) => b.pubDate - a.pubDate);
            
            // å»é‡é€»è¾‘
            const seen = new Set();
            allNewsData = allNewsData.filter(item => {
                if(seen.has(item.title)) return false;
                seen.add(item.title);
                return true;
            });

            renderNews(allNewsData);

        } catch (error) {
            container.innerHTML = `<div class="status-msg" style="color:#ef4444; border-color:#ef4444;">
                ğŸš« æ•°æ®è¿æ¥ä¸­æ–­<br>è¯·æ£€æŸ¥ç½‘ç»œæˆ–ç¨ååˆ·æ–°ã€‚<br><small>${error.message}</small>
            </div>`;
        }
    }

    function renderNews(newsItems) {
        const container = document.getElementById('news-grid');
        
        if (newsItems.length === 0) {
            container.innerHTML = `<div class="status-msg">ğŸ“­ æš‚æ— æœ€æ–°ç›¸å…³æ–°é—»ï¼Œè¯·ç¨åå†è¯•ã€‚</div>`;
            return;
        }

        container.innerHTML = newsItems.map(item => {
            const timeStr = item.pubDate.toLocaleString('zh-CN', {month:'2-digit', day:'2-digit', hour:'2-digit', minute:'2-digit'});
            
            return `
                <div class="news-card ${item.categoryType}">
                    <div class="news-meta">
                        <span class="tag ${item.tagClass}">${item.sourceLabel}</span>
                        <span>${timeStr}</span>
                    </div>
                    <h3 class="news-title">
                        <a href="${item.link}" target="_blank">${item.title}</a>
                    </h3>
                    <div class="news-desc">${item.desc}</div>
                </div>
            `;
        }).join('');
    }

    // è¿‡æ»¤åŠŸèƒ½
    window.filterNews = function(type, btn) {
        document.querySelectorAll('.filter-btn').forEach(b => {
            b.classList.remove('active');
            b.classList.remove('gold-btn'); // ç§»é™¤ç‰¹æ®Šé¢œè‰²ç±»
            b.classList.remove('ind-btn');
        });
        
        btn.classList.add('active');
        // æ¢å¤ç‰¹æ®Šé¢œè‰²
        if(type === 'type-precious') btn.classList.add('gold-btn');
        if(type === 'type-industry') btn.classList.add('ind-btn');

        if (type === 'all') {
            renderNews(allNewsData);
        } else {
            const filtered = allNewsData.filter(item => item.categoryType === type);
            if(filtered.length === 0) {
                document.getElementById('news-grid').innerHTML = `<div class="status-msg">ğŸ“­ è¯¥åˆ†ç±»ä¸‹æš‚æ— æœ€æ–°æ¶ˆæ¯ã€‚</div>`;
            } else {
                renderNews(filtered);
            }
        }
    }

    // å¯åŠ¨
    fetchAllNews();
</script>

</body>
</html>
